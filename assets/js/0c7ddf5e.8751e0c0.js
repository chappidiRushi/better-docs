"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[1765],{5001(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Node/crypto","title":"crypto Module","description":"Cryptography utilities: hashes, HMAC, ciphers, signatures, keys, random bytes","source":"@site/docs/Node/crypto.md","sourceDirName":"Node","slug":"/Node/crypto","permalink":"/docs/Node/crypto","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Node/crypto.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"console Module","permalink":"/docs/Node/console"},"next":{"title":"events Module","permalink":"/docs/Node/event"}}');var t=s(4848),i=s(8453);const a={},c="crypto Module",o={},d=[{value:"Import (ESM)",id:"import-esm",level:2},{value:"Hashing",id:"hashing",level:2},{value:"Hash / Hmac Methods",id:"hash--hmac-methods",level:2},{value:"Ciphers (Encryption)",id:"ciphers-encryption",level:2},{value:"Cipher / Decipher Methods",id:"cipher--decipher-methods",level:2},{value:"Signing &amp; Verification",id:"signing--verification",level:2},{value:"Sign / Verify Methods",id:"sign--verify-methods",level:2},{value:"Key Generation &amp; Handling",id:"key-generation--handling",level:2},{value:"Randomness",id:"randomness",level:2},{value:"Password / Key Derivation",id:"password--key-derivation",level:2},{value:"Crypto Constants",id:"crypto-constants",level:2},{value:"Notes",id:"notes",level:2}];function l(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsxs)(n.h1,{id:"crypto-module",children:[(0,t.jsx)(n.code,{children:"crypto"})," Module"]})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Cryptography utilities: hashes, HMAC, ciphers, signatures, keys, random bytes"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"import-esm",children:"Import (ESM)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import {\n  // Hashing\n  createHash,\n  createHmac,\n  getHashes,\n\n  // Ciphers\n  createCipheriv,\n  createDecipheriv,\n  getCiphers,\n\n  // Sign / Verify\n  createSign,\n  createVerify,\n\n  // Key generation & handling\n  generateKeyPair,\n  generateKeyPairSync,\n  createPublicKey,\n  createPrivateKey,\n  createSecretKey,\n\n  // Randomness\n  randomBytes,\n  randomUUID,\n  randomFill,\n  randomFillSync,\n\n  // KDF / Passwords\n  pbkdf2,\n  pbkdf2Sync,\n  scrypt,\n  scryptSync,\n\n  // Constants\n  constants\n} from 'node:crypto';\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { createHash, randomBytes } from 'node:crypto';\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"hashing",children:"Hashing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Create hash instance\ncreateHash(algorithm, options?)        // (string, object?) \u2192 Hash\n// Create HMAC instance\ncreateHmac(algorithm, key, options?)   // (string, string|Buffer|KeyObject, object?) \u2192 Hmac\n// List supported hash algorithms\ngetHashes()                             // () \u2192 string[]\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"createHash('sha256', { outputLength: 32 });     // algorithm, options\ncreateHmac('sha256', 'secret', {});             // algorithm, key, options\ngetHashes();                                    // no args\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"hash--hmac-methods",children:"Hash / Hmac Methods"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Add data to hash\nhash.update(data, inputEnc?)           // (string|Buffer, string?) \u2192 this\n// Finalize hash\nhash.digest(outputEnc?)                // (string?) \u2192 Buffer|string\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"createHash('sha256')\n  .update('data', 'utf8')               // data, encoding\n  .digest('hex');                       // output encoding\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"ciphers-encryption",children:"Ciphers (Encryption)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Create cipher\ncreateCipheriv(alg, key, iv, opts?)    // (string, Buffer|KeyObject, Buffer, object?) \u2192 Cipher\n// Create decipher\ncreateDecipheriv(alg, key, iv, opts?)  // (string, Buffer|KeyObject, Buffer, object?) \u2192 Decipher\n// List supported ciphers\ngetCiphers()                           // () \u2192 string[]\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const key = randomBytes(32);            // key\nconst iv = randomBytes(16);             // iv\ncreateCipheriv('aes-256-cbc', key, iv, {});\ncreateDecipheriv('aes-256-cbc', key, iv, {});\ngetCiphers();\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"cipher--decipher-methods",children:"Cipher / Decipher Methods"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Encrypt/decrypt data\ncipher.update(data, inEnc?, outEnc?)   // (string|Buffer, string?, string?) \u2192 Buffer|string\n// Finalize cipher\ncipher.final(outEnc?)                  // (string?) \u2192 Buffer|string\n// Enable/disable padding\ncipher.setAutoPadding(auto)            // (boolean) \u2192 this\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"cipher.update('text', 'utf8', 'hex');   // data, inputEnc, outputEnc\ncipher.final('hex');                    // outputEnc\ncipher.setAutoPadding(true);            // boolean\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"signing--verification",children:"Signing & Verification"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Create signer\ncreateSign(algorithm)                  // (string) \u2192 Sign\n// Create verifier\ncreateVerify(algorithm)               // (string) \u2192 Verify\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"createSign('RSA-SHA256');\ncreateVerify('RSA-SHA256');\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"sign--verify-methods",children:"Sign / Verify Methods"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Add data to sign\nsign.update(data, inputEnc?)           // (string|Buffer, string?) \u2192 this\n// Generate signature\nsign.sign(key, outEnc?)                // (KeyObject|string|object, string?) \u2192 Buffer|string\n// Verify signature\nverify.verify(key, sig, sigEnc?)       // (KeyObject|string|object, Buffer|string, string?) \u2192 boolean\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"sign.update('msg', 'utf8');\nsign.sign(privateKey, 'hex');           // key, outputEnc\nverify.verify(publicKey, signature, 'hex');\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"key-generation--handling",children:"Key Generation & Handling"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Generate key pair (async)\ngenerateKeyPair(type, opts, cb)        // (string, object, Function) \u2192 void\n// Generate key pair (sync)\ngenerateKeyPairSync(type, opts)        // (string, object) \u2192 object\n// Create public key object\ncreatePublicKey(key)                   // (string|Buffer|object) \u2192 KeyObject\n// Create private key object\ncreatePrivateKey(key)                  // (string|Buffer|object) \u2192 KeyObject\n// Create secret key object\ncreateSecretKey(key)                   // (Buffer) \u2192 KeyObject\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"generateKeyPair('rsa', { modulusLength: 2048 }, () => {});\ngenerateKeyPairSync('rsa', { modulusLength: 2048 });\ncreatePublicKey(pubPem);\ncreatePrivateKey(privPem);\ncreateSecretKey(randomBytes(32));\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"randomness",children:"Randomness"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Generate cryptographically strong bytes\nrandomBytes(size, cb?)                // (number, Function?) \u2192 Buffer\n// Generate RFC 4122 UUID\nrandomUUID(opts?)                     // (object?) \u2192 string\n// Fill buffer with random data\nrandomFill(buf, offset?, size?, cb)   // (Buffer, number?, number?, Function) \u2192 void\n// Sync version\nrandomFillSync(buf, offset?, size?)   // (Buffer, number?, number?) \u2192 Buffer\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"randomBytes(16);                       // size\nrandomUUID({ disableEntropyCache: false });\nrandomFill(Buffer.alloc(8), 0, 8, () => {});\nrandomFillSync(Buffer.alloc(8), 0, 8);\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"password--key-derivation",children:"Password / Key Derivation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// PBKDF2 (async)\npbkdf2(pwd, salt, iter, len, digest, cb) // (string|Buffer, string|Buffer, number, number, string, Function) \u2192 void\n// PBKDF2 (sync)\npbkdf2Sync(pwd, salt, iter, len, digest)  // (...) \u2192 Buffer\n// Scrypt (async)\nscrypt(pwd, salt, len, opts?, cb)        // (string|Buffer, string|Buffer, number, object?, Function) \u2192 void\n// Scrypt (sync)\nscryptSync(pwd, salt, len, opts?)        // (...) \u2192 Buffer\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"pbkdf2('pass', 'salt', 1000, 32, 'sha256', () => {});\npbkdf2Sync('pass', 'salt', 1000, 32, 'sha256');\nscrypt('pass', 'salt', 32, { N: 16384 }, () => {});\nscryptSync('pass', 'salt', 32, { N: 16384 });\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"crypto-constants",children:"Crypto Constants"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// RSA padding modes\nconstants.RSA_PKCS1_PADDING\nconstants.RSA_PKCS1_PSS_PADDING\n\n// Diffie-Hellman\nconstants.DH_CHECK_P_NOT_SAFE_PRIME\n\n// Timing-safe compare result\nconstants.CRYPTO_BUFFER_SIZE\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"constants.RSA_PKCS1_PADDING;            // padding mode\nconstants.CRYPTO_BUFFER_SIZE;           // internal buffer size\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Prefer ",(0,t.jsx)(n.code,{children:"scrypt"})," for password hashing"]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"randomBytes"})," for secrets"]}),"\n",(0,t.jsx)(n.li,{children:"Never reuse IVs with block ciphers"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>c});var r=s(6540);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);