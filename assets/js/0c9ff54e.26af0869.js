"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[2483],{2850(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"mongo/mongodb-backup-restore-dr","title":"Backup, Restore, and Disaster Recovery","description":"-----------------","source":"@site/docs/mongo/Backup and Restore.md","sourceDirName":"mongo","slug":"/mongo/mongodb-backup-restore-dr","permalink":"/better-docs/docs/mongo/mongodb-backup-restore-dr","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/mongo/Backup and Restore.md","tags":[],"version":"current","sidebarPosition":17,"frontMatter":{"id":"mongodb-backup-restore-dr","title":"Backup, Restore, and Disaster Recovery","sidebar_position":17},"sidebar":"tutorialSidebar","previous":{"title":"Security","permalink":"/better-docs/docs/mongo/mongodb-security"},"next":{"title":"Monitoring and Operations","permalink":"/better-docs/docs/mongo/mongodb-monitoring-operations"}}');var i=s(4848),r=s(8453);const t={id:"mongodb-backup-restore-dr",title:"Backup, Restore, and Disaster Recovery",sidebar_position:17},l=void 0,c={},a=[{value:"Logical Backups",id:"logical-backups",level:2},{value:"Physical Backups",id:"physical-backups",level:2},{value:"Point-in-Time Recovery (PITR)",id:"point-in-time-recovery-pitr",level:2},{value:"Restore Pitfalls",id:"restore-pitfalls",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"logical-backups",children:"Logical Backups"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Exporting data at logical (document/collection) level"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Uses ",(0,i.jsx)(n.code,{children:"mongodump"})," / ",(0,i.jsx)(n.code,{children:"mongorestore"})]}),"\n",(0,i.jsx)(n.li,{children:"BSON-based, schema-aware"}),"\n",(0,i.jsx)(n.li,{children:"Slower, but portable"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Trigger logical backup via child process\nimport { exec } from 'node:child_process';\n\nexec('mongodump --uri=\"mongodb://user:pass@host:27017/app\" --out ./dump');\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"physical-backups",children:"Physical Backups"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Copying raw database files from disk"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Storage-engine specific"}),"\n",(0,i.jsx)(n.li,{children:"Fast restore"}),"\n",(0,i.jsx)(n.li,{children:"Requires filesystem-level consistency"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Snapshot orchestration (example abstraction)\nawait adminDb.command({ fsync: 1, lock: true });\n// take volume snapshot externally\nawait adminDb.command({ fsyncUnlock: 1 });\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"point-in-time-recovery-pitr",children:"Point-in-Time Recovery (PITR)"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Restoring data to an exact moment"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Requires oplog"}),"\n",(0,i.jsx)(n.li,{children:"Common in replica sets"}),"\n",(0,i.jsx)(n.li,{children:"Combine snapshot + oplog replay"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Check oplog window\nconst status = await adminDb.command({ replSetGetStatus: 1 });\nstatus.members.forEach(m => console.log(m.optime));\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"restore-pitfalls",children:"Restore Pitfalls"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Common restore-time failures and mistakes"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Index rebuild cost"}),"\n",(0,i.jsx)(n.li,{children:"UUID / namespace conflicts"}),"\n",(0,i.jsx)(n.li,{children:"Version incompatibility"}),"\n",(0,i.jsx)(n.li,{children:"Dropping admin/local by mistake"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Dangerous restore example\nexec('mongorestore --drop ./dump'); // Drops existing collections\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Test restores regularly"}),"\n",(0,i.jsx)(n.li,{children:"Backups without restore tests are useless"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Logical backups impact performance"}),"\n",(0,i.jsx)(n.li,{children:"Physical backups are unsafe without fsync"}),"\n",(0,i.jsx)(n.li,{children:"PITR increases storage and ops complexity"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>t,x:()=>l});var o=s(6540);const i={},r=o.createContext(i);function t(e){const n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);