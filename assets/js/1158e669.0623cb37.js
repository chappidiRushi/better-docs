"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[7612],{8453(e,n,i){i.d(n,{R:()=>c,x:()=>d});var s=i(6540);const l={},r=s.createContext(l);function c(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),s.createElement(r.Provider,{value:n},e.children)}},8680(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"html/security","title":"Security","description":"-----------------","source":"@site/docs/html/Security.md","sourceDirName":"html","slug":"/html/security","permalink":"/better-docs/docs/html/security","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/html/Security.md","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"id":"security","title":"Security","sidebar_position":20},"sidebar":"tutorialSidebar","previous":{"title":"HTML and Accessibility (A11y)","permalink":"/better-docs/docs/html/html-and-accessibility-a11y"},"next":{"title":"Internationalization (i18n)","permalink":"/better-docs/docs/html/html-i18n"}}');var l=i(4848),r=i(8453);const c={id:"security",title:"Security",sidebar_position:20},d=void 0,t={},o=[{value:"Unified Example (Security Controls in HTML)",id:"unified-example-security-controls-in-html",level:2},{value:"Same-Origin Policy",id:"same-origin-policy",level:2},{value:"CORS Basics",id:"cors-basics",level:2},{value:"Content Security Policy (CSP)",id:"content-security-policy-csp",level:2},{value:"XSS and HTML Injection",id:"xss-and-html-injection",level:2},{value:"Clickjacking",id:"clickjacking",level:2},{value:"Sandbox Mechanisms",id:"sandbox-mechanisms",level:2},{value:"<code>&lt;iframe sandbox&gt;</code>",id:"iframe-sandbox",level:3},{value:"<code>sandbox</code> Attribute on Links",id:"sandbox-attribute-on-links",level:3},{value:"Trusted Types",id:"trusted-types",level:2},{value:"Often-Missed Details (Hardcore)",id:"often-missed-details-hardcore",level:2},{value:"Mental Model (Interview Grade)",id:"mental-model-interview-grade",level:2}];function a(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"unified-example-security-controls-in-html",children:"Unified Example (Security Controls in HTML)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'\x3c!-- SAME-ORIGIN & CORS --\x3e\n<script src="https://cdn.example.com/app.js" crossorigin="anonymous"><\/script> \x3c!-- anonymous | use-credentials --\x3e\n\n\x3c!-- CSP META (fallback only) --\x3e\n<meta http-equiv="Content-Security-Policy"\n      content="default-src \'self\'; script-src \'self\'; object-src \'none\'">\n\n\x3c!-- IFRAME SANDBOX --\x3e\n<iframe src="https://third-party.example"\n        sandbox="allow-scripts allow-forms"  \x3c!-- granular capability flags --\x3e\n        referrerpolicy="no-referrer">\n</iframe>\n\n\x3c!-- CLICKJACKING DEFENSE (server headers preferred) --\x3e\n<style>\n  body { frame-ancestors: \'none\'; } /* illustrative only */\n</style>\n\n\x3c!-- TRUSTED TYPES (JS-enforced, declared via CSP) --\x3e\n<script>\n  // unsafe assignment blocked when Trusted Types enforced\n  // element.innerHTML = userInput; // TypeError\n<\/script>\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"same-origin-policy",children:"Same-Origin Policy"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Core browser isolation model"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Origin = scheme + host + port"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Restricts:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"DOM access"}),"\n",(0,l.jsx)(n.li,{children:"JS execution context"}),"\n",(0,l.jsx)(n.li,{children:"Storage (cookies, localStorage)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Allowed across origins:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Navigation"}),"\n",(0,l.jsx)(n.li,{children:"Embedding (with restrictions)"}),"\n",(0,l.jsx)(n.li,{children:"Resource fetching (subject to CORS)"}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["One-liner: ",(0,l.jsx)(n.em,{children:"Origins isolate execution and data by default."})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"cors-basics",children:"CORS Basics"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Opt-in relaxation of SOP"}),"\n",(0,l.jsx)(n.li,{children:"Controlled via HTTP headers"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Key headers:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Access-Control-Allow-Origin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Access-Control-Allow-Methods"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Access-Control-Allow-Headers"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Access-Control-Allow-Credentials"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"HTML attributes involved:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'crossorigin="anonymous | use-credentials"'})}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["One-liner: ",(0,l.jsx)(n.em,{children:"CORS is a permission system layered on top of SOP."})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"content-security-policy-csp",children:"Content Security Policy (CSP)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Declarative injection defense"}),"\n",(0,l.jsx)(n.li,{children:"Delivered via HTTP header (preferred) or meta tag"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Common directives:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"default-src"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"script-src"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"style-src"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"img-src"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"frame-ancestors"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Inline control:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"nonce-*"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"hash-*"})}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["One-liner: ",(0,l.jsx)(n.em,{children:"CSP restricts what the browser is allowed to execute or load."})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"xss-and-html-injection",children:"XSS and HTML Injection"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Occurs when untrusted input becomes executable"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Vectors:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Inline scripts"}),"\n",(0,l.jsxs)(n.li,{children:["Event handler attributes (",(0,l.jsx)(n.code,{children:"onclick"}),")"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"innerHTML"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Mitigations:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Output encoding"}),"\n",(0,l.jsx)(n.li,{children:"CSP"}),"\n",(0,l.jsx)(n.li,{children:"Trusted Types"}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["One-liner: ",(0,l.jsx)(n.em,{children:"XSS is a failure to separate data from code."})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"clickjacking",children:"Clickjacking"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"UI redress attack via framing"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Defenses:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"X-Frame-Options: DENY | SAMEORIGIN"})}),"\n",(0,l.jsxs)(n.li,{children:["CSP ",(0,l.jsx)(n.code,{children:"frame-ancestors"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"<iframe sandbox>"})," restrictions"]}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["One-liner: ",(0,l.jsx)(n.em,{children:"Clickjacking exploits visual trust, not code execution."})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"sandbox-mechanisms",children:"Sandbox Mechanisms"}),"\n",(0,l.jsx)(n.h3,{id:"iframe-sandbox",children:(0,l.jsx)(n.code,{children:"<iframe sandbox>"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Starts with zero privileges"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Flags selectively re-enable capabilities:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"allow-scripts"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"allow-same-origin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"allow-forms"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"allow-popups"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"sandbox-attribute-on-links",children:[(0,l.jsx)(n.code,{children:"sandbox"})," Attribute on Links"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<a href="https://example.com" rel="noopener noreferrer">Link</a>\n'})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["One-liner: ",(0,l.jsx)(n.em,{children:"Sandboxing removes ambient authority."})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"trusted-types",children:"Trusted Types"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"DOM-based XSS mitigation"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Enforced via CSP:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"require-trusted-types-for 'script'"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Disallows string assignment to sensitive sinks:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"innerHTML"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"outerHTML"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"insertAdjacentHTML"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["One-liner: ",(0,l.jsx)(n.em,{children:"Trusted Types make unsafe DOM APIs uncallable by default."})]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"often-missed-details-hardcore",children:"Often-Missed Details (Hardcore)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"<base>"})," can be abused for injection"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"javascript:"})," URLs are blocked by CSP"]}),"\n",(0,l.jsx)(n.li,{children:"SVG introduces scriptable surfaces"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"noopener"})," prevents opener-based attacks"]}),"\n",(0,l.jsx)(n.li,{children:"DOM clobbering can bypass naive defenses"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"mental-model-interview-grade",children:"Mental Model (Interview Grade)"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"HTML security is about minimizing ambient authority: origins isolate, CSP constrains execution, sandboxing removes privilege, and Trusted Types eliminate entire bug classes."})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);