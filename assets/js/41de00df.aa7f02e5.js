"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[8305],{8453(e,n,s){s.d(n,{R:()=>r,x:()=>c});var o=s(6540);const t={},i=o.createContext(t);function r(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),o.createElement(i.Provider,{value:n},e.children)}},9739(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"mongo/mongoose-architecture-core-concepts","title":"Mongoose Architecture and Core Concepts","description":"-----------------","source":"@site/docs/mongo/Mongoose Architecture.md","sourceDirName":"mongo","slug":"/mongo/mongoose-architecture-core-concepts","permalink":"/better-docs/docs/mongo/mongoose-architecture-core-concepts","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/mongo/Mongoose Architecture.md","tags":[],"version":"current","sidebarPosition":23,"frontMatter":{"id":"mongoose-architecture-core-concepts","title":"Mongoose Architecture and Core Concepts","sidebar_position":23},"sidebar":"tutorialSidebar","previous":{"title":"Mongoose as an Abstraction Layer","permalink":"/better-docs/docs/mongo/mongoose-abstraction-layer"},"next":{"title":"Mongoose Connections and Topology","permalink":"/better-docs/docs/mongo/mongoose-connections-topology"}}');var t=s(4848),i=s(8453);const r={id:"mongoose-architecture-core-concepts",title:"Mongoose Architecture and Core Concepts",sidebar_position:23},c=void 0,l={},a=[{value:"Connections",id:"connections",level:2},{value:"Schemas",id:"schemas",level:2},{value:"Models",id:"models",level:2},{value:"Documents",id:"documents",level:2},{value:"Execution Flow",id:"execution-flow",level:2},{value:"Internal Abstractions",id:"internal-abstractions",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"connections",children:"Connections"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Managed MongoDB driver connections with lifecycle control"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Wraps MongoClient internally"}),"\n",(0,t.jsx)(n.li,{children:"Supports multiple connections"}),"\n",(0,t.jsx)(n.li,{children:"Global vs connection-scoped models"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples (Node.js)"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import mongoose from 'mongoose';\n\nawait mongoose.connect('mongodb://localhost:27017/app', {\n  maxPoolSize: 10,        // number\n  minPoolSize: 2,         // number\n  serverSelectionTimeoutMS: 5000, // number\n});\n\n// Multiple connections\nconst conn = mongoose.createConnection('mongodb://localhost:27017/logs');\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"schemas",children:"Schemas"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Declarative definition of document structure and behavior"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Schema-on-write"}),"\n",(0,t.jsx)(n.li,{children:"Handles casting, defaults, validation"}),"\n",(0,t.jsx)(n.li,{children:"Schema != MongoDB schema"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples (Node.js)"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const schema = new mongoose.Schema({\n  name: { type: String, index: true },     // String | Number | Date | Buffer | ObjectId\n  status: { type: String, enum: ['A','I'] },\n  meta: { type: Map, of: String },\n}, {\n  strict: true,        // true | false | 'throw'\n  timestamps: true,    // boolean | object\n});\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"models",children:"Models"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Compiled constructors providing query and write APIs"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Tied to a connection + schema"}),"\n",(0,t.jsx)(n.li,{children:"Acts as query builder"}),"\n",(0,t.jsx)(n.li,{children:"Model methods are static"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples (Node.js)"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const User = mongoose.model('User', schema);\n\nawait User.find({ status: 'A' });\nawait User.create({ name: 'x', status: 'A' });\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"documents",children:"Documents"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Runtime instances representing MongoDB documents"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Hydrated objects"}),"\n",(0,t.jsx)(n.li,{children:"Change tracking via internal state"}),"\n",(0,t.jsx)(n.li,{children:"Validation on save"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples (Node.js)"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const doc = new User({ name: 'john', status: 'A' });\n\nconsole.log(doc.isNew); // true\nawait doc.save();\nconsole.log(doc.isModified('name')); // false\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"execution-flow",children:"Execution Flow"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"End-to-end path of a Mongoose operation"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Cast \u2192 validate \u2192 middleware \u2192 driver call"}),"\n",(0,t.jsx)(n.li,{children:"Queries are lazily executed"}),"\n",(0,t.jsx)(n.li,{children:"Results are hydrated unless lean"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples (Node.js)"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Query is not executed until awaited\nconst q = User.findOne({ status: 'A' });\n\n// Middleware + casting + execution happens here\nconst result = await q.exec();\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"internal-abstractions",children:"Internal Abstractions"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Key internal layers used by Mongoose"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Query"}),"\n",(0,t.jsx)(n.li,{children:"Document"}),"\n",(0,t.jsx)(n.li,{children:"SchemaType"}),"\n",(0,t.jsx)(n.li,{children:"Connection / Collection wrappers"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Examples (Node.js)"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Access internal query object\nconst query = User.find({});\nconsole.log(query.constructor.name); // Query\n\n// SchemaType example\nconsole.log(schema.path('name').instance); // String\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Mongoose sits entirely client-side"}),"\n",(0,t.jsx)(n.li,{children:"All features compile down to driver operations"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Debugging requires understanding internals"}),"\n",(0,t.jsx)(n.li,{children:"Abstraction leaks under complex workloads"}),"\n",(0,t.jsx)(n.li,{children:"Performance tuning often needs driver-level knowledge"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);