"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[5990],{8453(e,n,o){o.d(n,{R:()=>t,x:()=>a});var s=o(6540);const i={},r=s.createContext(i);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(r.Provider,{value:n},e.children)}},9589(e,n,o){o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"mongo/mongoose-abstraction-layer","title":"Mongoose as an Abstraction Layer","description":"-----------------","source":"@site/docs/mongo/Mongoose Intro.md","sourceDirName":"mongo","slug":"/mongo/mongoose-abstraction-layer","permalink":"/better-docs/docs/mongo/mongoose-abstraction-layer","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/mongo/Mongoose Intro.md","tags":[],"version":"current","sidebarPosition":22,"frontMatter":{"id":"mongoose-abstraction-layer","title":"Mongoose as an Abstraction Layer","sidebar_position":22},"sidebar":"tutorialSidebar","previous":{"title":"MongoDB Limits, Edge Cases, and Anti-Patterns","permalink":"/better-docs/docs/mongo/mongodb-limits-edge-cases"},"next":{"title":"Mongoose Architecture and Core Concepts","permalink":"/better-docs/docs/mongo/mongoose-architecture-core-concepts"}}');var i=o(4848),r=o(8453);const t={id:"mongoose-abstraction-layer",title:"Mongoose as an Abstraction Layer",sidebar_position:22},a=void 0,l={},d=[{value:"ODM Philosophy",id:"odm-philosophy",level:2},{value:"Mongoose vs Native Driver",id:"mongoose-vs-native-driver",level:2},{value:"Tradeoffs and Overhead",id:"tradeoffs-and-overhead",level:2},{value:"When <em>Not</em> to Use Mongoose",id:"when-not-to-use-mongoose",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:o}=n;return o||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"odm-philosophy",children:"ODM Philosophy"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Mapping MongoDB documents to application-level models"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Opinionated schema-on-write"}),"\n",(0,i.jsx)(n.li,{children:"Adds validation, middleware, and defaults"}),"\n",(0,i.jsx)(n.li,{children:"Optimizes developer productivity, not raw performance"}),"\n"]}),"\n",(0,i.jsxs)(o,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"import mongoose from 'mongoose';\n\nconst userSchema = new mongoose.Schema({\n  email: { type: String, required: true }, // String | Number | Date | Boolean | ObjectId\n  age: { type: Number, min: 0 },\n}, { timestamps: true });\n\nconst User = mongoose.model('User', userSchema);\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"mongoose-vs-native-driver",children:"Mongoose vs Native Driver"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"High-level ODM vs low-level database driver"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Mongoose adds schema, hooks, casting"}),"\n",(0,i.jsx)(n.li,{children:"Native driver gives full MongoDB feature access"}),"\n",(0,i.jsx)(n.li,{children:"Mongoose lags behind new MongoDB features"}),"\n"]}),"\n",(0,i.jsxs)(o,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Mongoose\nawait User.findOne({ email: 'a@b.com' });\n\n// Native driver\nawait db.collection('users').findOne({ email: 'a@b.com' });\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"tradeoffs-and-overhead",children:"Tradeoffs and Overhead"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Cost of abstraction at runtime and design time"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Extra memory per document"}),"\n",(0,i.jsx)(n.li,{children:"Additional query transformation layer"}),"\n",(0,i.jsx)(n.li,{children:"Implicit behavior can hide inefficiencies"}),"\n"]}),"\n",(0,i.jsxs)(o,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Document hydration overhead\nconst doc = await User.findOne();\nconsole.log(doc instanceof mongoose.Document); // true\n\n// Lean query avoids hydration\nawait User.findOne().lean(); // returns plain JS object\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"when-not-to-use-mongoose",children:["When ",(0,i.jsx)(n.em,{children:"Not"})," to Use Mongoose"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Scenarios where ODM hurts more than helps"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"High-throughput systems"}),"\n",(0,i.jsx)(n.li,{children:"Heavy aggregation pipelines"}),"\n",(0,i.jsx)(n.li,{children:"Rapidly evolving schemas"}),"\n",(0,i.jsx)(n.li,{children:"Advanced MongoDB features usage"}),"\n"]}),"\n",(0,i.jsxs)(o,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Prefer native driver for complex aggregation\nawait db.collection('events').aggregate([\n  { $match: { type: 'CLICK' } },\n  { $group: { _id: '$userId', c: { $sum: 1 } } }\n]);\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Mongoose is a productivity tool, not a database feature"}),"\n",(0,i.jsx)(n.li,{children:"Lean queries mitigate some overhead"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Hidden queries via middleware"}),"\n",(0,i.jsx)(n.li,{children:"Schema mismatch can cause runtime errors"}),"\n",(0,i.jsx)(n.li,{children:"Not ideal for MongoDB power-users"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);