"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[6999],{1439(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"css/css-performance-pipeline","title":"Performance & Rendering Pipeline","description":"-----------------","source":"@site/docs/css/Performance & Rendering Pipeline.md","sourceDirName":"css","slug":"/css/css-performance-pipeline","permalink":"/better-docs/docs/css/css-performance-pipeline","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/css/Performance & Rendering Pipeline.md","tags":[],"version":"current","sidebarPosition":26,"frontMatter":{"id":"css-performance-pipeline","title":"Performance & Rendering Pipeline","sidebar_position":26},"sidebar":"tutorialSidebar","previous":{"title":"User Interaction & Input Styling","permalink":"/better-docs/docs/css/css-user-interaction"},"next":{"title":"Scoping, Shadow DOM & Encapsulation","permalink":"/better-docs/docs/css/css-shadow-dom"}}');var l=i(4848),r=i(8453);const c={id:"css-performance-pipeline",title:"Performance & Rendering Pipeline",sidebar_position:26},t=void 0,o={},a=[{value:"Rendering Pipeline Overview",id:"rendering-pipeline-overview",level:2},{value:"Style Calculation",id:"style-calculation",level:2},{value:"Layout Thrashing",id:"layout-thrashing",level:2},{value:"Paint vs Composite",id:"paint-vs-composite",level:2},{value:"Stacking &amp; Layer Promotion",id:"stacking--layer-promotion",level:2},{value:"CSS Containment",id:"css-containment",level:2},{value:"<code>content-visibility</code>",id:"content-visibility",level:2},{value:"GPU Myths",id:"gpu-myths",level:2},{value:"Debugging Performance",id:"debugging-performance",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"rendering-pipeline-overview",children:"Rendering Pipeline Overview"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"Browsers process CSS in ordered phases. Not all changes trigger all phases."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Pipeline stages:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Style calculation"})," \u2013 resolve cascaded & computed values"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Layout (reflow)"})," \u2013 calculate box geometry"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Paint"})," \u2013 rasterize pixels into layers"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Composite"})," \u2013 GPU combines layers"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"Style \u2192 Layout \u2192 Paint \u2192 Composite\n"})}),"\n",(0,l.jsx)(n.p,{children:"Invalidation can stop early if changes are isolated."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"style-calculation",children:"Style Calculation"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"Resolves cascade, inheritance, variables, media/container queries."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Triggers:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Class/attribute changes"}),"\n",(0,l.jsx)(n.li,{children:"Variable updates"}),"\n",(0,l.jsx)(n.li,{children:"Media query changes"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Cost characteristics:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Tree-wide when variables are used high in DOM"}),"\n",(0,l.jsx)(n.li,{children:"Scoped when selectors are narrow"}),"\n"]}),"\n",(0,l.jsxs)(i,{children:[(0,l.jsx)("summary",{children:"Examples"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:"/* Expensive: variable defined on :root */\n:root {\n  --theme-color: red;\n}\n\n/* Cheaper: scoped variable */\n.card {\n  --theme-color: red;\n}\n"})})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"layout-thrashing",children:"Layout Thrashing"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["Forced synchronous layout caused by ",(0,l.jsx)(n.strong,{children:"read-after-write"})," patterns."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Common layout reads:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"offsetWidth / offsetHeight"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"getBoundingClientRect()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"scrollTop"})}),"\n"]}),"\n",(0,l.jsxs)(i,{children:[(0,l.jsx)("summary",{children:"Examples"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"// BAD: thrashing\nel.style.width = '200px';\nconsole.log(el.offsetWidth); // forces layout\n\n// GOOD: batch reads/writes\nel.style.width = '200px';\nrequestAnimationFrame(() => {\n  console.log(el.offsetWidth);\n});\n"})})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"paint-vs-composite",children:"Paint vs Composite"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"Not all visual changes repaint pixels."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Categories:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Layout-affecting"})," \u2192 layout + paint + composite"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Paint-only"})," \u2192 paint + composite"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Composite-only"})," \u2192 composite only (GPU)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Composite-only properties:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:"transform\nopacity\nfilter /* partial */\n"})}),"\n",(0,l.jsxs)(i,{children:[(0,l.jsx)("summary",{children:"Examples"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:"/* Cheap animation */\n.box {\n  transform: translateX(100px);\n}\n\n/* Expensive animation */\n.box {\n  width: 200px; /* layout + paint */\n}\n"})})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"stacking--layer-promotion",children:"Stacking & Layer Promotion"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"Elements may be promoted to composited layers."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Triggers:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"transform"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"opacity < 1"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"position: fixed"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"will-change"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Layer cost:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"GPU memory"}),"\n",(0,l.jsx)(n.li,{children:"Upload overhead"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"css-containment",children:"CSS Containment"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"Explicitly limits how changes propagate."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Blueprint:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:"contain:\n  none |\n  size |\n  layout |\n  paint |\n  style |\n  strict | /* size + layout + paint + style */\n  content; /* layout + paint + style */\n"})}),"\n",(0,l.jsx)(n.p,{children:"Effects:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Stops layout & paint invalidation"}),"\n",(0,l.jsx)(n.li,{children:"Creates new formatting context"}),"\n"]}),"\n",(0,l.jsxs)(i,{children:[(0,l.jsx)("summary",{children:"Examples"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:".card {\n  contain: layout paint;\n}\n"})})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"content-visibility",children:(0,l.jsx)(n.code,{children:"content-visibility"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"Skips rendering work for off-screen content."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Blueprint:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:"content-visibility: visible | hidden | auto;\ncontain-intrinsic-size: <length> | auto;\n"})}),"\n",(0,l.jsx)(n.p,{children:"Rules:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"auto"})," skips layout & paint when offscreen"]}),"\n",(0,l.jsx)(n.li,{children:"Requires intrinsic size to prevent jumps"}),"\n"]}),"\n",(0,l.jsxs)(i,{children:[(0,l.jsx)("summary",{children:"Examples"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:".section {\n  content-visibility: auto;\n  contain-intrinsic-size: 800px;\n}\n"})})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"gpu-myths",children:"GPU Myths"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"GPU acceleration is not free."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Reality:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Too many layers hurt performance"}),"\n",(0,l.jsx)(n.li,{children:"Uploading textures is expensive"}),"\n",(0,l.jsx)(n.li,{children:"GPU does not fix layout bottlenecks"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Bad practices:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Blanket ",(0,l.jsx)(n.code,{children:"will-change"})]}),"\n",(0,l.jsx)(n.li,{children:"Animating layout properties"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"debugging-performance",children:"Debugging Performance"}),"\n",(0,l.jsx)(n.p,{children:"Tools:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Chrome DevTools \u2192 Performance"}),"\n",(0,l.jsx)(n.li,{children:"Layers panel"}),"\n",(0,l.jsx)(n.li,{children:"Paint flashing"}),"\n",(0,l.jsx)(n.li,{children:"Rendering stats"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Most performance wins come from ",(0,l.jsx)(n.strong,{children:"avoiding layout"})]}),"\n",(0,l.jsx)(n.li,{children:"Composite-only animations are safest"}),"\n",(0,l.jsx)(n.li,{children:"Containment is the strongest CSS performance tool"}),"\n",(0,l.jsx)(n.li,{children:"Measure before optimizing"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Overusing containment breaks intrinsic sizing"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"content-visibility"})," can harm accessibility if misused"]}),"\n",(0,l.jsx)(n.li,{children:"GPU memory is finite"}),"\n",(0,l.jsx)(n.li,{children:"Performance characteristics vary per browser"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>c,x:()=>t});var s=i(6540);const l={},r=s.createContext(l);function c(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);