"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[2172],{918(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"mongo/mongoose-schemas-schematypes","title":"Mongoose Schemas and SchemaTypes","description":"-----------------","source":"@site/docs/mongo/Mongoose Schema.md","sourceDirName":"mongo","slug":"/mongo/mongoose-schemas-schematypes","permalink":"/better-docs/docs/mongo/mongoose-schemas-schematypes","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/mongo/Mongoose Schema.md","tags":[],"version":"current","sidebarPosition":25,"frontMatter":{"id":"mongoose-schemas-schematypes","title":"Mongoose Schemas and SchemaTypes","sidebar_position":25},"sidebar":"tutorialSidebar","previous":{"title":"Mongoose Connections and Topology","permalink":"/better-docs/docs/mongo/mongoose-connections-topology"},"next":{"title":"Mongoose Models and Compilation","permalink":"/better-docs/docs/mongo/mongoose-models-compilation"}}');var i=s(4848),t=s(8453);const r={id:"mongoose-schemas-schematypes",title:"Mongoose Schemas and SchemaTypes",sidebar_position:25},l=void 0,c={},a=[{value:"Schema Construction",id:"schema-construction",level:2},{value:"Built-in SchemaTypes",id:"built-in-schematypes",level:2},{value:"Custom SchemaTypes",id:"custom-schematypes",level:2},{value:"Default Values",id:"default-values",level:2},{value:"Immutability",id:"immutability",level:2},{value:"Strict Mode Variants",id:"strict-mode-variants",level:2},{value:"Schema Options",id:"schema-options",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"schema-construction",children:"Schema Construction"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Declarative blueprint for documents enforced at write-time"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Schema-on-write abstraction"}),"\n",(0,i.jsx)(n.li,{children:"Controls casting, validation, defaults"}),"\n",(0,i.jsx)(n.li,{children:"Independent of MongoDB server"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"import mongoose from 'mongoose';\n\nconst userSchema = new mongoose.Schema({\n  name: String,                 // shorthand\n  age: { type: Number },        // explicit\n  email: { type: String, index: true },\n}, {\n  timestamps: true,             // boolean | object\n  versionKey: '__v',             // string | false\n});\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"built-in-schematypes",children:"Built-in SchemaTypes"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Native data types supported by Mongoose"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Extend MongoDB BSON types"}),"\n",(0,i.jsx)(n.li,{children:"Handle casting automatically"}),"\n",(0,i.jsx)(n.li,{children:"Type mismatch throws at runtime"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const schema = new mongoose.Schema({\n  str: String,                  // String\n  num: Number,                  // Number\n  bool: Boolean,                // Boolean\n  date: Date,                   // Date\n  buf: Buffer,                  // Buffer\n  id: mongoose.Schema.Types.ObjectId, // ObjectId\n  arr: [String],                // Array\n  map: { type: Map, of: Number },// Map\n  mixed: mongoose.Schema.Types.Mixed, // Mixed\n});\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"custom-schematypes",children:"Custom SchemaTypes"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Extending Mongoose with domain-specific types"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Built on top of SchemaType"}),"\n",(0,i.jsx)(n.li,{children:"Rarely needed"}),"\n",(0,i.jsx)(n.li,{children:"Increases complexity"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"class LowercaseString extends mongoose.SchemaType {\n  cast(val) {\n    if (typeof val !== 'string') throw new Error('String required');\n    return val.toLowerCase();\n  }\n}\n\nmongoose.Schema.Types.LowercaseString = LowercaseString;\n\nconst schema = new mongoose.Schema({\n  email: { type: LowercaseString },\n});\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"default-values",children:"Default Values"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Automatically assigned values on document creation"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Applied at instantiation time"}),"\n",(0,i.jsx)(n.li,{children:"Can be static or function"}),"\n",(0,i.jsx)(n.li,{children:"Not applied on updates by default"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const schema = new mongoose.Schema({\n  role: { type: String, default: 'user' },        // static\n  createdAt: { type: Date, default: Date.now },  // function\n});\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"immutability",children:"Immutability"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Preventing changes to fields after creation"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enforced by Mongoose"}),"\n",(0,i.jsx)(n.li,{children:"Does not affect MongoDB directly"}),"\n",(0,i.jsx)(n.li,{children:"Useful for IDs and audit fields"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const schema = new mongoose.Schema({\n  email: { type: String, immutable: true }, // boolean | function\n});\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"strict-mode-variants",children:"Strict Mode Variants"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Handling of unknown fields"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Applied at schema level"}),"\n",(0,i.jsx)(n.li,{children:"Affects writes only"}),"\n",(0,i.jsx)(n.li,{children:"Helps catch data drift"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"new mongoose.Schema({ name: String }, {\n  strict: true,    // true | false | 'throw'\n});\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"schema-options",children:"Schema Options"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Global behavior configuration for schemas"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Affects validation, serialization, and writes"}),"\n",(0,i.jsx)(n.li,{children:"Can be overridden per schema"}),"\n",(0,i.jsx)(n.li,{children:"Important for performance tuning"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples (Node.js)"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const schema = new mongoose.Schema({ name: String }, {\n  strict: true,\n  timestamps: true,\n  minimize: true,      // remove empty objects\n  autoIndex: false,    // disable index build in prod\n  toJSON: { virtuals: true },\n  toObject: { virtuals: true },\n});\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"SchemaTypes control casting and validation"}),"\n",(0,i.jsx)(n.li,{children:"Defaults and immutability are client-side guarantees"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Mongoose schemas do not enforce server-side constraints"}),"\n",(0,i.jsx)(n.li,{children:"Mixed types disable validation"}),"\n",(0,i.jsx)(n.li,{children:"Overuse of custom types complicates maintenance"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>r,x:()=>l});var o=s(6540);const i={},t=o.createContext(i);function r(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);