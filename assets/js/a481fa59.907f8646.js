"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[1364],{5509(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"mongo/mongodb-wiredtiger","title":"Storage Engine (WiredTiger)","description":"-----------------","source":"@site/docs/mongo/Storage Engine.md","sourceDirName":"mongo","slug":"/mongo/mongodb-wiredtiger","permalink":"/better-docs/docs/mongo/mongodb-wiredtiger","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/mongo/Storage Engine.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"id":"mongodb-wiredtiger","title":"Storage Engine (WiredTiger)","sidebar_position":12},"sidebar":"tutorialSidebar","previous":{"title":"Sharding","permalink":"/better-docs/docs/mongo/mongodb-sharding"},"next":{"title":"Performance and Optimization","permalink":"/better-docs/docs/mongo/mongodb-performance-optimization"}}');var r=i(4848),o=i(8453);const t={id:"mongodb-wiredtiger",title:"Storage Engine (WiredTiger)",sidebar_position:12},l=void 0,c={},a=[{value:"WiredTiger Architecture",id:"wiredtiger-architecture",level:2},{value:"MVCC",id:"mvcc",level:2},{value:"Journaling",id:"journaling",level:2},{value:"Compression",id:"compression",level:2},{value:"Cache Management",id:"cache-management",level:2},{value:"Read vs Write Amplification",id:"read-vs-write-amplification",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"wiredtiger-architecture",children:"WiredTiger Architecture"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Log-structured storage engine with B-Tree data organization"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Collection and index data stored separately"}),"\n",(0,r.jsx)(n.li,{children:"Uses B-Trees with page-level locking"}),"\n",(0,r.jsx)(n.li,{children:"Pluggable storage engine"}),"\n"]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// WiredTiger is enabled by default\n// Verify engine\nawait adminDb.command({ serverStatus: 1 }).then(r => r.storageEngine);\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"mvcc",children:"MVCC"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Multi-Version Concurrency Control for isolation"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Readers don\u2019t block writers"}),"\n",(0,r.jsx)(n.li,{children:"Snapshot isolation"}),"\n",(0,r.jsx)(n.li,{children:"Versioned documents"}),"\n"]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Snapshot isolation via transaction\nconst session = client.startSession();\n\nsession.startTransaction({\n  readConcern: { level: 'snapshot' }\n});\n\nawait db.collection('orders').findOne({ _id: 1 }, { session });\n\nawait session.commitTransaction();\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"journaling",children:"Journaling"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Write-ahead logging for durability"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sequential journal writes"}),"\n",(0,r.jsx)(n.li,{children:"Crash recovery support"}),"\n",(0,r.jsx)(n.li,{children:"Enabled by default"}),"\n"]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Check journaling status\nawait adminDb.command({ getCmdLineOpts: 1 });\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"compression",children:"Compression"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Reduces disk and cache usage"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Block compression (Snappy / Zstd / Zlib)"}),"\n",(0,r.jsx)(n.li,{children:"Collection-level configuration"}),"\n",(0,r.jsx)(n.li,{children:"Index compression supported"}),"\n"]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Create collection with compression\nawait db.createCollection('logs', {\n  storageEngine: {\n    wiredTiger: {\n      blockCompressor: 'zstd' // snappy | zlib | zstd | none\n    }\n  }\n});\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"cache-management",children:"Cache Management"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"In-memory cache for hot data"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Default ~50% RAM"}),"\n",(0,r.jsx)(n.li,{children:"Shared between indexes and data"}),"\n",(0,r.jsx)(n.li,{children:"LRU eviction"}),"\n"]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Inspect cache usage\nawait adminDb.command({ serverStatus: 1 }).then(r => r.wiredTiger.cache);\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"read-vs-write-amplification",children:"Read vs Write Amplification"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Tradeoff between read efficiency and write cost"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Write amplification due to journaling + compaction"}),"\n",(0,r.jsx)(n.li,{children:"Read amplification reduced by caching"}),"\n",(0,r.jsx)(n.li,{children:"Compression increases CPU cost"}),"\n"]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// High write workload example\nawait db.collection('metrics').updateOne(\n  { _id: 1 },\n  { $inc: { count: 1 } },\n  { upsert: true }\n);\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"WiredTiger is optimized for SSDs"}),"\n",(0,r.jsx)(n.li,{children:"Enables high concurrency workloads"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Heavy writes increase write amplification"}),"\n",(0,r.jsx)(n.li,{children:"Cache pressure impacts latency"}),"\n",(0,r.jsx)(n.li,{children:"Compression trades CPU for IO savings"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>t,x:()=>l});var s=i(6540);const r={},o=s.createContext(r);function t(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);