"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[9995],{6491(e,n,i){i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"mongo/mongodb-schema-validation","title":"Schema Validation","description":"-----------------","source":"@site/docs/mongo/Schema Validation.md","sourceDirName":"mongo","slug":"/mongo/mongodb-schema-validation","permalink":"/better-docs/docs/mongo/mongodb-schema-validation","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/mongo/Schema Validation.md","tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"id":"mongodb-schema-validation","title":"Schema Validation","sidebar_position":15},"sidebar":"tutorialSidebar","previous":{"title":"Data Modeling Patterns","permalink":"/better-docs/docs/mongo/mongodb-data-modeling-patterns"},"next":{"title":"Security","permalink":"/better-docs/docs/mongo/mongodb-security"}}');var s=i(4848),a=i(8453);const o={id:"mongodb-schema-validation",title:"Schema Validation",sidebar_position:15},l=void 0,r={},d=[{value:"JSON Schema Validation",id:"json-schema-validation",level:2},{value:"Validation Levels and Actions",id:"validation-levels-and-actions",level:2},{value:"Migration Strategies",id:"migration-strategies",level:2},{value:"Performance Impact",id:"performance-impact",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"json-schema-validation",children:"JSON Schema Validation"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Uses JSON Schema to validate documents on insert and update"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Implemented via ",(0,s.jsx)(n.code,{children:"$jsonSchema"})]}),"\n",(0,s.jsx)(n.li,{children:"Validates shape, types, required fields"}),"\n",(0,s.jsx)(n.li,{children:"Applied per collection"}),"\n"]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Examples (Node.js)"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Create collection with JSON Schema validation\nawait db.createCollection('users', {\n  validator: {\n    $jsonSchema: {\n      bsonType: 'object',\n      required: ['email', 'age'],\n      properties: {\n        email: {\n          bsonType: 'string',\n          description: 'must be a string'\n        },\n        age: {\n          bsonType: 'int', // int | long | double | decimal\n          minimum: 18\n        },\n        tags: {\n          bsonType: 'array', // array | object | string | number\n          items: { bsonType: 'string' }\n        }\n      }\n    }\n  }\n});\n"})})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"validation-levels-and-actions",children:"Validation Levels and Actions"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Controls when validation runs and how failures are handled"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"validationLevel"}),": strict | moderate"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"validationAction"}),": error | warn"]}),"\n",(0,s.jsx)(n.li,{children:"Tunable without downtime"}),"\n"]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Examples (Node.js)"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Modify validation behavior\nawait db.command({\n  collMod: 'users',\n  validationLevel: 'moderate', // strict | moderate\n  validationAction: 'warn'     // error | warn\n});\n"})})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"migration-strategies",children:"Migration Strategies"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Evolving schemas without breaking existing data"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Relax validation during migration"}),"\n",(0,s.jsx)(n.li,{children:"Backfill data incrementally"}),"\n",(0,s.jsx)(n.li,{children:"Tighten rules after cleanup"}),"\n"]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Examples (Node.js)"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Step 1: Relax validation\nawait db.command({\n  collMod: 'users',\n  validationAction: 'warn'\n});\n\n// Step 2: Backfill missing fields\nawait db.collection('users').updateMany(\n  { age: { $exists: false } },\n  { $set: { age: 18 } }\n);\n\n// Step 3: Enforce strict validation\nawait db.command({\n  collMod: 'users',\n  validationLevel: 'strict',\n  validationAction: 'error'\n});\n"})})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"performance-impact",children:"Performance Impact"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Cost of validation during write operations"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Impacts insert/update latency"}),"\n",(0,s.jsx)(n.li,{children:"Complex schemas cost more CPU"}),"\n",(0,s.jsx)(n.li,{children:"No impact on reads"}),"\n"]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Examples (Node.js)"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Write-heavy workload with validation\nawait db.collection('events').insertMany(docs, {\n  ordered: false // reduces latency despite validation\n});\n"})})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Validation complements application-level checks"}),"\n",(0,s.jsx)(n.li,{children:"Best used for critical invariants"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Not a replacement for full schema migrations"}),"\n",(0,s.jsx)(n.li,{children:"Overly strict schemas reduce agility"}),"\n",(0,s.jsx)(n.li,{children:"Validation errors surface at write time"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>o,x:()=>l});var t=i(6540);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);