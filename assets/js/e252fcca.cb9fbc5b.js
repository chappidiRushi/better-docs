"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[1170],{2009(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"css/css-shadow-dom","title":"Scoping, Shadow DOM & Encapsulation","description":"-----------------","source":"@site/docs/css/Scoping, Shadow DOM & Encapsulation.md","sourceDirName":"css","slug":"/css/css-shadow-dom","permalink":"/better-docs/docs/css/css-shadow-dom","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/css/Scoping, Shadow DOM & Encapsulation.md","tags":[],"version":"current","sidebarPosition":27,"frontMatter":{"id":"css-shadow-dom","title":"Scoping, Shadow DOM & Encapsulation","sidebar_position":27},"sidebar":"tutorialSidebar","previous":{"title":"Performance & Rendering Pipeline","permalink":"/better-docs/docs/css/css-performance-pipeline"},"next":{"title":"Interop, Security & Spec Gaps","permalink":"/better-docs/docs/css/css-interop-security"}}');var i=s(4848),r=s(8453);const t={id:"css-shadow-dom",title:"Scoping, Shadow DOM & Encapsulation",sidebar_position:27},o=void 0,c={},d=[{value:"Shadow Tree Styling Model",id:"shadow-tree-styling-model",level:2},{value:"<code>:host</code>",id:"host",level:2},{value:"<code>::part()</code>",id:"part",level:2},{value:"CSS Variable Piercing",id:"css-variable-piercing",level:2},{value:"Style Isolation Guarantees",id:"style-isolation-guarantees",level:2},{value:"Encapsulation Patterns",id:"encapsulation-patterns",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function a(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"shadow-tree-styling-model",children:"Shadow Tree Styling Model"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Each shadow root creates an isolated styling scope."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Key rules:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Styles in light DOM ",(0,i.jsx)(n.strong,{children:"do not cross"})," into shadow DOM"]}),"\n",(0,i.jsxs)(n.li,{children:["Styles in shadow DOM ",(0,i.jsx)(n.strong,{children:"do not leak out"})]}),"\n",(0,i.jsx)(n.li,{children:"Shadow DOM has its own cascade & tree order"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Shadow tree types:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Open"})," \u2192 JS-accessible (",(0,i.jsx)(n.code,{children:"element.shadowRoot"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Closed"})," \u2192 JS-inaccessible (CSS rules identical)"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"Document Tree\n \u2514\u2500 Custom Element\n     \u2514\u2500 Shadow Root (new style scope)\n"})}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:"<my-card></my-card>\n\n<script>\nclass MyCard extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.shadowRoot.innerHTML = `\n      <style>\n        p { color: red; }\n      </style>\n      <p>Shadow text</p>\n    `;\n  }\n}\n<\/script>\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"host",children:(0,i.jsx)(n.code,{children:":host"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Targets the ",(0,i.jsx)(n.strong,{children:"custom element itself"})," from inside its shadow tree."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Blueprint:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:":host\n:host(<selector>)\n:host-context(<selector>) /* legacy / limited */\n"})}),"\n",(0,i.jsx)(n.p,{children:"Rules:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:":host"})," replaces styling the custom element"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:":host()"})," allows conditional styling"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:":host-context()"})," matches ancestors (discouraged)"]}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:':host {\n  display: block;\n}\n\n:host([variant="danger"]) {\n  border: 1px solid red;\n}\n'})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"part",children:(0,i.jsx)(n.code,{children:"::part()"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Controlled, explicit styling API for shadow internals."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Blueprint:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:"::part(name)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Rules:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Parts must be explicitly exposed"}),"\n",(0,i.jsx)(n.li,{children:"Only exposed parts are stylable"}),"\n",(0,i.jsx)(n.li,{children:"No selector chaining inside shadow tree"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'\x3c!-- shadow DOM --\x3e\n<button part="label">OK</button>\n'})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:"my-button::part(label) {\n  font-weight: bold;\n}\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"css-variable-piercing",children:"CSS Variable Piercing"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Custom properties ",(0,i.jsx)(n.strong,{children:"cross shadow boundaries by design"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Rules:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Variables inherit into shadow trees"}),"\n",(0,i.jsx)(n.li,{children:"Variables are the primary theming mechanism"}),"\n",(0,i.jsx)(n.li,{children:"Resolution still happens at computed-value time"}),"\n"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Examples"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:":root {\n  --brand-color: blue;\n}\n\nmy-card {\n  --brand-color: green;\n}\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:"/* inside shadow DOM */\n.title {\n  color: var(--brand-color);\n}\n"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"style-isolation-guarantees",children:"Style Isolation Guarantees"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Shadow DOM provides ",(0,i.jsx)(n.strong,{children:"strong isolation"}),", unlike CSS Modules or BEM."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Isolated by default:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Selectors"}),"\n",(0,i.jsx)(n.li,{children:"Specificity wars"}),"\n",(0,i.jsx)(n.li,{children:"Accidental overrides"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Not isolated:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Fonts"}),"\n",(0,i.jsx)(n.li,{children:"Custom properties"}),"\n",(0,i.jsx)(n.li,{children:"UA styles"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"encapsulation-patterns",children:"Encapsulation Patterns"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Real-world component systems rely on layered APIs."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Common patterns:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Internal styles \u2192 hard-coded"}),"\n",(0,i.jsx)(n.li,{children:"Theme tokens \u2192 CSS variables"}),"\n",(0,i.jsxs)(n.li,{children:["Surface hooks \u2192 ",(0,i.jsx)(n.code,{children:"::part"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Anti-patterns:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Styling via deep selectors"}),"\n",(0,i.jsxs)(n.li,{children:["Excessive ",(0,i.jsx)(n.code,{children:":host-context"})]}),"\n",(0,i.jsx)(n.li,{children:"Re-exporting internals via parts"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Shadow DOM is a ",(0,i.jsx)(n.strong,{children:"hard boundary"}),", not a naming convention"]}),"\n",(0,i.jsx)(n.li,{children:"Variables are the sanctioned escape hatch"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"::part"})," is safer than selector piercing"]}),"\n",(0,i.jsx)(n.li,{children:"Encapsulation improves long-term maintainability"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Overexposing parts weakens encapsulation"}),"\n",(0,i.jsx)(n.li,{children:"Variables can create implicit coupling"}),"\n",(0,i.jsx)(n.li,{children:"Shadow DOM does not fix bad semantics"}),"\n",(0,i.jsx)(n.li,{children:"Tooling support varies across browsers"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>t,x:()=>o});var l=s(6540);const i={},r=l.createContext(i);function t(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);