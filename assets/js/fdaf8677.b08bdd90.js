"use strict";(globalThis.webpackChunkbetter_docs=globalThis.webpackChunkbetter_docs||[]).push([[6172],{3242(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"mongo/mongodb-data-modeling-patterns","title":"Data Modeling Patterns","description":"-----------------","source":"@site/docs/mongo/Data Modelling Patterns.md","sourceDirName":"mongo","slug":"/mongo/mongodb-data-modeling-patterns","permalink":"/better-docs/docs/mongo/mongodb-data-modeling-patterns","draft":false,"unlisted":false,"editUrl":"https://github.com/chappidirushi/better-docs/tree/main/docs/mongo/Data Modelling Patterns.md","tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"id":"mongodb-data-modeling-patterns","title":"Data Modeling Patterns","sidebar_position":15},"sidebar":"tutorialSidebar","previous":{"title":"Performance and Optimization","permalink":"/better-docs/docs/mongo/mongodb-performance-optimization"},"next":{"title":"Schema Validation","permalink":"/better-docs/docs/mongo/mongodb-schema-validation"}}');var r=s(4848),t=s(8453);const d={id:"mongodb-data-modeling-patterns",title:"Data Modeling Patterns",sidebar_position:15},l=void 0,o={},c=[{value:"Embedding Patterns",id:"embedding-patterns",level:2},{value:"Referencing Patterns",id:"referencing-patterns",level:2},{value:"Bucket Pattern",id:"bucket-pattern",level:2},{value:"Polymorphic Pattern",id:"polymorphic-pattern",level:2},{value:"Tree Structures",id:"tree-structures",level:2},{value:"Time-Series Modeling",id:"time-series-modeling",level:2},{value:"Event Sourcing",id:"event-sourcing",level:2},{value:"Notes",id:"notes",level:2},{value:"Caveats",id:"caveats",level:2}];function a(e){const n={blockquote:"blockquote",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"embedding-patterns",children:"Embedding Patterns"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Store related data inside a single document"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Optimizes read performance"}),"\n",(0,r.jsx)(n.li,{children:"Single-document atomicity"}),"\n",(0,r.jsx)(n.li,{children:"Document size limit applies"}),"\n"]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Embedded address inside user\nawait db.collection('users').insertOne({\n  _id: 1,\n  name: 'A',\n  addresses: [\n    { city: 'NY', zip: '10001' },\n    { city: 'SF', zip: '94101' }\n  ]\n});\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"referencing-patterns",children:"Referencing Patterns"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Store relationships using document references"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reduces document size"}),"\n",(0,r.jsx)(n.li,{children:"Requires joins ($lookup or app-side)"}),"\n",(0,r.jsx)(n.li,{children:"Suitable for high-cardinality relations"}),"\n"]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// User reference in orders\nawait db.collection('orders').insertOne({\n  _id: 101,\n  userId: 1, // reference\n  amount: 500\n});\n\n// Application-side join\nconst order = await db.collection('orders').findOne({ _id: 101 });\nconst user = await db.collection('users').findOne({ _id: order.userId });\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"bucket-pattern",children:"Bucket Pattern"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Group multiple related records into buckets"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reduces document count"}),"\n",(0,r.jsx)(n.li,{children:"Common for time-series"}),"\n",(0,r.jsx)(n.li,{children:"Tradeoff between update and read cost"}),"\n"]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Bucketed sensor readings\nawait db.collection('metrics').updateOne(\n  { sensorId: 's1', bucket: '2025-01-01' },\n  {\n    $push: { values: { ts: Date.now(), v: 42 } },\n    $inc: { count: 1 }\n  },\n  { upsert: true }\n);\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"polymorphic-pattern",children:"Polymorphic Pattern"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Store different document shapes in one collection"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Flexible schema"}),"\n",(0,r.jsx)(n.li,{children:"Requires discriminator field"}),"\n",(0,r.jsx)(n.li,{children:"Indexing must account for shape variance"}),"\n"]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"await db.collection('assets').insertMany([\n  { type: 'car', wheels: 4, brand: 'BMW' },\n  { type: 'bike', wheels: 2, brand: 'Yamaha' }\n]);\n\n// Query specific subtype\nawait db.collection('assets').find({ type: 'car' }).toArray();\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"tree-structures",children:"Tree Structures"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Represent hierarchical data"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Parent reference, materialized path, or nested set"}),"\n",(0,r.jsx)(n.li,{children:"Tradeoff between read and write complexity"}),"\n"]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Parent reference model\nawait db.collection('categories').insertMany([\n  { _id: 1, name: 'Electronics', parentId: null },\n  { _id: 2, name: 'Laptops', parentId: 1 }\n]);\n\n// Fetch children\nawait db.collection('categories').find({ parentId: 1 }).toArray();\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"time-series-modeling",children:"Time-Series Modeling"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Optimized design for time-based data"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Append-only workload"}),"\n",(0,r.jsx)(n.li,{children:"Leverages bucket pattern"}),"\n",(0,r.jsx)(n.li,{children:"Native time-series collections available"}),"\n"]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Time-series collection\nawait db.createCollection('events', {\n  timeseries: {\n    timeField: 'ts',\n    metaField: 'deviceId',\n    granularity: 'seconds' // seconds | minutes | hours\n  }\n});\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"event-sourcing",children:"Event Sourcing"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Persist state changes as immutable events"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interview points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Append-only writes"}),"\n",(0,r.jsx)(n.li,{children:"Rebuild state by replaying events"}),"\n",(0,r.jsx)(n.li,{children:"Strong auditability"}),"\n"]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:"Examples (Node.js)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Append event\nawait db.collection('order_events').insertOne({\n  orderId: 1,\n  type: 'ORDER_PAID',\n  payload: { amount: 500 },\n  ts: new Date()\n});\n\n// Replay events\nawait db.collection('order_events')\n  .find({ orderId: 1 })\n  .sort({ ts: 1 })\n  .toArray();\n"})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Schema design dominates performance"}),"\n",(0,r.jsx)(n.li,{children:"Prefer embedding unless growth or cardinality forbids"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"caveats",children:"Caveats"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Over-embedding causes document growth issues"}),"\n",(0,r.jsx)(n.li,{children:"Excessive referencing increases query cost"}),"\n",(0,r.jsx)(n.li,{children:"Polymorphism complicates indexing"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>d,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function d(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);